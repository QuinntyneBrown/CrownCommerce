<section class="shop-hero">
  <span class="shop-hero__label">THE COLLECTION</span>
  <h1 class="shop-hero__title">Shop Premium Virgin Hair</h1>
  <lib-divider variant="accent" />
  <p class="shop-hero__description">
    Explore our curated collection of 100% virgin hair extensions, sourced ethically
    from around the world. Every bundle, closure, and frontal is crafted for lasting beauty.
  </p>
</section>

@if (loading()) {
  <div class="shop__loading">
    <lib-loading-spinner />
  </div>
} @else if (error()) {
  <div class="shop__error-container">
    <lib-error-state [message]="error()!" />
  </div>
} @else {
  <div class="shop__content">
    <aside class="shop__sidebar">
      <h3 class="shop__sidebar-title">Filters</h3>

      <div class="shop__filter-group">
        <h4 class="shop__filter-heading">Category</h4>
        <button class="shop__filter-item" [class.active]="!activeCategory()" (click)="filterByCategory(null)">All</button>
        @for (cat of categories; track cat) {
          <button class="shop__filter-item" [class.active]="activeCategory() === cat" (click)="filterByCategory(cat)">{{ cat }}</button>
        }
      </div>

      <div class="shop__filter-group">
        <h4 class="shop__filter-heading">Texture</h4>
        <button class="shop__filter-item" [class.active]="!activeTexture()" (click)="filterByTexture(null)">All</button>
        @for (tex of textures; track tex) {
          <button class="shop__filter-item" [class.active]="activeTexture() === tex" (click)="filterByTexture(tex)">{{ tex }}</button>
        }
      </div>

      <div class="shop__filter-group">
        <h4 class="shop__filter-heading">Length</h4>
        <button class="shop__filter-item" [class.active]="!activeLength()" (click)="filterByLength(null)">All</button>
        @for (len of lengths; track len) {
          <button class="shop__filter-item" [class.active]="activeLength() === len" (click)="filterByLength(len)">{{ len }}"</button>
        }
      </div>

      <div class="shop__filter-group">
        <h4 class="shop__filter-heading">Price</h4>
        <button class="shop__filter-item" [class.active]="!activePriceRange()" (click)="filterByPrice(null)">All</button>
        @for (range of priceRanges; track range.label) {
          <button class="shop__filter-item" [class.active]="activePriceRange() === range.label" (click)="filterByPrice(range.label)">{{ range.label }}</button>
        }
      </div>
    </aside>

    <main class="shop__main">
      <div class="shop__sort-bar">
        <span class="shop__count">Showing {{ productCount() }} products</span>
        <select class="shop__sort" (change)="sortProducts($any($event.target).value)">
          <option value="name">Sort by Name</option>
          <option value="price-asc">Price: Low to High</option>
          <option value="price-desc">Price: High to Low</option>
          <option value="newest">Newest</option>
        </select>
      </div>

      @if (filteredProducts().length === 0) {
        <p class="shop__status">No products match your filters.</p>
      } @else {
        <div class="shop__grid">
          @for (product of filteredProducts(); track product.id) {
            <lib-product-card
              [imageUrl]="product.imageUrl ?? ''"
              [tag]="product.type.toUpperCase()"
              [title]="product.name"
              [description]="product.description"
              [price]="formatPrice(product)"
              [showShopButton]="true"
              (click)="navigateToProduct(product)"
            />
          }
        </div>
      }
    </main>
  </div>
}
